<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-styles/typography.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-icons/maps-icons.html">
<link rel="import" href="../bower_components/iron-icons/social-icons.html">
<link rel="import" href="../bower_components/iron-icons/editor-icons.html">
<link rel="import" href="../bower_components/iron-icons/notification-icons.html">
<link rel="import" href="../bower_components/iron-icons/device-icons.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="../bower_components/paper-item/paper-icon-item.html">
<link rel="import" href="../bower_components/paper-item/paper-item-body.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/iron-collapse/iron-collapse.html">

<link rel="import" href="../bower_components/paper-styles/typography.html">
<link rel="import" href="shared-styles.html">

<dom-module id="view-init">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
      }
      .subhead {
        @apply(--paper-font-subhead);
        color: var(--app-secondary-text);
        margin-bottom: 0.5rem;
      }
      .avatar {
        display: flex;
        box-sizing: border-box;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: var(--app-primary-color);
        color: var(--app-white-text);
        align-items: center;
        justify-content: center;
      }

      .section paper-material {
        margin: 0;
        padding: 0;
      }
      .grid {
        display: flex;
        flex-direction: column;
      }
      @media (min-width: 40rem) {
        .grid {
          flex-direction: row;
        }
      }

      .grid .section {
        width: calc(100% - 1rem);
        margin: 0.5rem  0 0.5rem 0.5rem;
      }
      .grid .section:last-child {
        margin-right: 0.5rem;
      }
      @media (min-width: 40rem) {
        .grid .section {
          width: 50%;
        }
      }

      .secondary iron-icon{
        color: var(--app-secondary-text);
      }
      .more {
        display: block;
        text-align: center;
        color: var(--app-secondary-color);
      }
    </style>

    <app-header-layout>
      <app-header fixed condenses effects="waterfall">
        <app-toolbar>
          <paper-icon-button menu-icon icon="menu" on-click="_openMenu"></paper-icon-button>
          <div main-title>
            In√≠cio
          </div>
        </app-toolbar>
      </app-header>

      <iron-media-query query="(min-width: 40rem)" query-matches="{{queryMatches}}"></iron-media-query>

      <div class="grid">
        <div class="section receitas">
          <paper-material elevation="1">
            <paper-icon-item>
              <div class="avatar" item-icon>
                <iron-icon icon="trending-up"></iron-icon>
              </div>
              <paper-item-body two-line>
                <span>Receita</span>
                <span secondary>R$ 6.982,50</span>
              </paper-item-body>
              <paper-icon-button id="receipt-collapse-button"
                                 icon="expand-less"
                                 on-click="_toogleReceiptCollapse"></paper-icon-button>
            </paper-icon-item>

            <iron-collapse id="receipt-collapse"
                           on-opened-changed="_openedReceiptCollapseChanged">
              <paper-icon-item class="secondary">
                <iron-icon icon="notification:event-note" item-icon></iron-icon>
                <paper-item-body two-line>
                  <span>R$ 62,00</span>
                  <span secondary>Consulta em 26/08 16h30</span>
                </paper-item-body>
              </paper-icon-item>
              <paper-icon-item class="secondary">
                <iron-icon icon="notification:event-note" item-icon></iron-icon>
                <paper-item-body two-line>
                  <span>R$ 62,00</span>
                  <span secondary>Consulta em 26/08 14h15</span>
                </paper-item-body>
              </paper-icon-item>
              <paper-icon-item class="secondary">
                <iron-icon icon="maps:local-hospital" item-icon></iron-icon>
                <paper-item-body two-line>
                  <span>R$ 2.500,00</span>
                  <span secondary>Atendimento Hospital</span>
                </paper-item-body>
              </paper-icon-item>

              <paper-button class="more">
                Mais
              </paper-button>
            </iron-collapse>
          </paper-material>
        </div>

        <div class="section despesas">
            <paper-material elevation="1">
              <paper-icon-item>
                <div class="avatar" item-icon>
                  <iron-icon icon="trending-down"></iron-icon>
                </div>
                <paper-item-body two-line>
                  <span>Despesas</span>
                  <span secondary>R$ 2.049,00</span>
                </paper-item-body>
                <paper-icon-button id="costs-collapse-button"
                                   icon="expand-less"
                                   on-click="_toogleCostsCollapse"></paper-icon-button>
              </paper-icon-item>

              <iron-collapse id="costs-collapse"
                             on-opened-changed="_openedCostsCollapseChanged">
                <paper-icon-item class="secondary">
                  <iron-icon icon="device:data-usage" item-icon></iron-icon>
                  <paper-item-body two-line>
                    <span>R$ 1.100,00</span>
                    <span secondary>Quota</span>
                  </paper-item-body>
                </paper-icon-item>
                <paper-icon-item class="secondary">
                  <iron-icon icon="maps:layers" item-icon></iron-icon>
                  <paper-item-body two-line>
                    <span>R$ 200,00</span>
                    <span secondary>Imposto</span>
                  </paper-item-body>
                </paper-icon-item>
                <paper-icon-item class="secondary">
                  <iron-icon icon="maps:layers" item-icon></iron-icon>
                  <paper-item-body two-line>
                    <span>R$ 122,00</span>
                    <span secondary>Imposto</span>
                  </paper-item-body>
                </paper-icon-item>

                <paper-button class="more">
                  Mais
                </paper-button>
              </iron-collapse>
            </paper-material>
        </div>
      </div>

    </app-header-layout>
  </template>
  <script>
    Polymer({
      is: 'view-init',

      properties: {
        queryMatches: {
          type: Boolean,
          observer: '_queryMatchesObserver'
        }
      },

      _openMenu: function() {
        this.fire('menu-click');
      },

      _queryMatchesObserver: function(isWide) {
        if (isWide) {
          this.$['receipt-collapse'].show();
          this.$['costs-collapse'].show();
        } else {
          this.$['receipt-collapse'].hide();
          this.$['costs-collapse'].hide();
        }
      },

      _openedReceiptCollapseChanged: function (event) {
        const opened = event.detail.value;
        if (opened) {
          this.$['receipt-collapse-button'].icon = "expand-less";
        } else {
          this.$['receipt-collapse-button'].icon = "expand-more";
        }
      },

      _openedCostsCollapseChanged: function (event) {
        const opened = event.detail.value;
        if (opened) {
          this.$['costs-collapse-button'].icon = "expand-less";
        } else {
          this.$['costs-collapse-button'].icon = "expand-more";
        }
      },

      _toogleReceiptCollapse: function () {
        this.$['receipt-collapse'].toggle();
      },

      _toogleCostsCollapse: function () {
        this.$['costs-collapse'].toggle();
      },
    });
  </script>
</dom-module>
